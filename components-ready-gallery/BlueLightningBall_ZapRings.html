<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlueLightningBall_ZapRings</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
    <style> body { margin: 0; padding: 0; overflow: hidden; background: #000; } canvas { display: block; } </style>
</head>
<body>
    <script>
let time = 0;
let hueOffset = 0;

function setup() {
  createCanvas(800, 600);
  colorMode(HSB, 360, 100, 100, 100);
  strokeCap(ROUND);
}

function draw() {
  blendMode(BLEND);
  background(0, 10);
  blendMode(ADD);

  translate(width / 2, height / 2);

  time += 0.003;
  hueOffset = (hueOffset + 0.2) % 360;

  let segments = floor(map(constrain(mouseY, 0, height), 0, height, 4, 16));
  let complexity = map(constrain(mouseX, 0, width), 0, width, 0.5, 12);
  let zoom = sin(time * 0.5) * 50 + 150;

  for (let i = 0; i < segments; i++) {
    push();
    rotate(TWO_PI * i / segments);
    if (i % 2 === 0) {
      scale(1, -1);
    }
    drawNebula(complexity, zoom);
    drawCore(complexity, zoom);
    pop();
  }
}

function drawNebula(complexity, zoom) {
  noFill();
  let strands = 5;
  for (let i = 0; i < strands; i++) {
    let hue = (hueOffset + i * 50 + sin(time * 2 + i) * 20) % 360;
    stroke(hue, 80, 100, 20);
    strokeWeight(random(1, 3));

    beginShape();
    for (let a = 0; a < TWO_PI; a += 0.05) {
      let xOff = map(cos(a), -1, 1, 0, complexity) + time * 0.5;
      let yOff = map(sin(a), -1, 1, 0, complexity) + i * 10;
      let zOff = time * 0.7;

      let r = map(noise(xOff, yOff, zOff), 0, 1, zoom * 0.8, zoom * 2.5);
      let x = r * cos(a);
      let y = r * sin(a);
      vertex(x, y);
    }
    endShape(CLOSE);
  }
}

function drawCore(complexity, zoom) {
  noStroke();
  let layers = 7;
  for (let i = layers; i > 0; i--) {
    let ratio = i / layers;
    let hue = (hueOffset + ratio * 90 + cos(time + ratio * PI) * 30) % 360;
    fill(hue, 90, 100, 15);

    beginShape();
    for (let a = 0; a < TWO_PI; a += 0.02) {
      let xOff = map(cos(a + time), -1, 1, 0, complexity * ratio);
      let yOff = map(sin(a + time), -1, 1, 0, complexity * ratio);
      let zOff = time + i * 0.1;

      let r = map(noise(xOff, yOff, zOff), 0, 1, -zoom * 0.5, zoom * 0.5) * ratio;
      let x = (zoom * 0.7 * ratio + r) * cos(a);
      let y = (zoom * 0.7 * ratio + r) * sin(a);
      curveVertex(x, y);
    }
    endShape(CLOSE);
  }
}

function mousePressed() {
  background(100);
}
    </script>
</body>
</html>
